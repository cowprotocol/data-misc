import unittest

from src.subgraph.ens_data import get_names_for_wallets


class MyTestCase(unittest.TestCase):
    def test_ens_data_fetching(self):
        expected_ens_records = {
            "0x75f0e91e9cbbdac4ca253c0939f6d149fe4397ff": [
                "retirementlife.eth",
                "transactionhistory.eth",
                "vestingperiod.eth",
                "gfwallet.eth",
                "שקלים.eth",
                "unitedstatesofbitcoin.eth",
                "ihavealotofmoney.eth",
                "walletmixer.eth",
                "governancevote.eth",
                "smartcontractbridge.eth",
                "kingmessiah.eth",
                "lordbitcoin.eth",
                "vestingcontract.eth",
                "bitcoinscam.eth",
                "taxinvasion.eth",
                "automatedbot.eth",
                "restakingyield.eth",
                "bitcoinnn.eth",
                "סאטושינאקאמוטו.eth",
                "סאטושי.eth",
                "לאומי.eth",
                "chassidus.eth",
                "farmingpool.eth",
                "farmbridge.eth",
                "moonnn.eth",
                "straddleoption.eth",
                "neversold.eth",
                "twentytwentytwenty.eth",
                "teambtc.eth",
                "codeupdate.eth",
                "farmingcontract.eth",
                "ethpleb.eth",
                "coinnnn.eth",
                "girlfriendswallet.eth",
                "ethrestaking.eth",
                "farmingwallet.eth",
                "nywallet.eth",
                "algofund.eth",
                "chadfund.eth",
                "governanceproposal.eth",
                "daoooo.eth",
                "dividendpayment.eth",
                "illegalfunds.eth",
                "shillll.eth",
                "larpingwallet.eth",
                "082294.eth",
                "farmingdegen.eth",
                "princeethereum.eth",
                "ethereumpleb.eth",
                "hashingpower.eth",
                "smartcontractfactory.eth",
                "feerebate.eth",
                "poolfund.eth",
                "ammaggregator.eth",
                "fillme.eth",
                "hidad.eth",
                "lubavitcherrebbe.eth",
                "אנאפטי.eth",
                "concensuscontract.eth",
                "bitcoinoffice.eth",
                "hodllllll.eth",
                "yieldstaking.eth",
                "חסידות.eth",
                "soldtoearly.eth",
                "מענדי.eth",
                "mycryptofund.eth",
                "addressmixer.eth",
                "whenannouncement.eth",
                "factorymarketplace.eth",
                "bitcoinheadquarters.eth",
                "divinewisdom.eth",
                "08221994.eth",
                "sanctionedwallet.eth",
                "larpwallet.eth",
                "ccryptocurrency.eth",
                "bitcoinnation.eth",
                "normiewallet.eth",
                "nofunds.eth",
                "inflationfarm.eth",
                "dividendfarm.eth",
                "nfttttt.eth",
                "wwhale.eth",
                "cryptooffice.eth",
                "feestructure.eth",
                "stolenfunds.eth",
                "improvementproposal.eth",
                "cryptocurrencyyy.eth",
                "farmrewards.eth",
                "walletregistration.eth",
                "bitcoinbuyer.eth",
                "btcpleb.eth",
                "onchainfund.eth",
                "heymom.eth",
                "בנקהפועלים.eth",
                "walletttt.eth",
                "cryptooooo.eth",
                "developmentfund.eth",
                "phishingaddress.eth",
                "votingcontract.eth",
                "rewardsfarm.eth",
                "smartcontractmarketplace.eth",
                "bitcoinpleb.eth",
                "needfunds.eth",
                "fudddd.eth",
                "pleasescam.eth",
                "foundationfund.eth",
                "wenannouncement.eth",
                "בנקישראל.eth",
                "cryptoheadquarters.eth",
                "chasidut.eth",
                "princeether.eth",
                "chassidut.eth",
                "ethereummm.eth",
                "moneyyy.eth",
                "realinternetmoney.eth",
                "legocontract.eth",
                "chadfarmer.eth",
                "schoolofcrypto.eth",
                "100xaltcoin.eth",
                "optionsvault.eth",
                "rektbro.eth",
                "princebitcoin.eth",
                "chasidus.eth",
                "itstoolate.eth",
            ],
            "0x54c375c481f95ba43e2cecd6ef30631f55518f57": [
                "xlayer.eth",
                "selfzk.eth",
                "starkproof.eth",
                "cryptocurrencydao.eth",
                "scaleblock.eth",
                "privatecomputation.eth",
                "starkgraph.eth",
                "zkledger.eth",
                "starkrollup.eth",
                "zkoffice.eth",
                "zkresearch.eth",
                "blockchainlinks.eth",
                "zklove.eth",
                "zkgovernance.eth",
                "zksig.eth",
                "zkvoice.eth",
                "zkblack.eth",
                "proofid.eth",
                "zkvote.eth",
                "zksafe.eth",
                "zkblock.eth",
                "zkspace.eth",
                "zkbank.eth",
                "thordao.eth",
                "powerstark.eth",
                "faceprint.eth",
                "zkmail.eth",
                "zkethereum.eth",
                "desocid.eth",
                "zkdai.eth",
                "zkmagic.eth",
                "zkwww.eth",
                "moneywire.eth",
                "zkmarkets.eth",
                "zksystems.eth",
                "proofserver.eth",
                "zkblox.eth",
                "zkperson.eth",
                "zkhackathon.eth",
                "chainpolicy.eth",
                "zkdude.eth",
                "zkuniversity.eth",
                "datashard.eth",
                "metavm.eth",
                "stark0x.eth",
                "zkprogram.eth",
                "snarknode.eth",
                "multipartycomputation.eth",
                "factfulness.eth",
                "desocstate.eth",
                "zkcompound.eth",
                "zkguy.eth",
                "zkhouse.eth",
                "starknode.eth",
                "zkwiki.eth",
                "zkgraph.eth",
                "zkcircle.eth",
                "zkgaming.eth",
                "zkmix.eth",
                "geld.eth",
                "pigou.eth",
                "metadailynews.eth",
                "zknation.eth",
                "zkids.eth",
                "stark1.eth",
                "stark1337.eth",
                "zkmaker.eth",
                "zkdaidao.eth",
                "dataavailability.eth",
                "decentralisedorganisation.eth",
                "starkverse.eth",
                "zkvoting.eth",
                "zkpolling.eth",
                "starkone.eth",
                "zkrealm.eth",
                "zkzkrollup.eth",
                "zkcoms.eth",
                "zkgang.eth",
                "rednft.eth",
                "zkuniverse.eth",
                "zkuni.eth",
                "multipartycompute.eth",
                "securempc.eth",
                "0xrollup.eth",
                "zkplanet.eth",
                "zkservice.eth",
                "zkvm.eth",
                "decentralisedorganization.eth",
                "cadaster.eth",
                "zklog.eth",
                "zklayer.eth",
                "zkstake.eth",
                "bcnews.eth",
                "zkjobsboard.eth",
                "starkpower.eth",
                "zknews.eth",
                "bluenft.eth",
                "chainpolitics.eth",
                "zkserver.eth",
                "zkapps.eth",
                "zkstate.eth",
                "zkjpg.eth",
                "starkshark.eth",
                "zkjobs.eth",
                "webkey.eth",
                "zkvox.eth",
                "zkcomputer.eth",
                "starkhash.eth",
                "multichainbridge.eth",
                "zkdata.eth",
                "zkacademy.eth",
                "datanode.eth",
                "zkprotocol.eth",
                "zkwtf.eth",
                "zkkey.eth",
                "zkdollar.eth",
                "1337nft.eth",
                "zkkit.eth",
                "zkfarm.eth",
                "idproof.eth",
                "zkmpc.eth",
                "layerdao.eth",
                "l22022.eth",
                "zktrust.eth",
                "zkchat.eth",
                "zklib.eth",
                "zksearch.eth",
                "starkwire.eth",
                "zkorg.eth",
                "decentralizedorganization.eth",
                "zkname.eth",
                "zkmeetup.eth",
                "zkcadastre.eth",
                "zkhack.eth",
                "zkscaling.eth",
                "rolluplink.eth",
                "dataaccess.eth",
                "zkvault.eth",
                "zkworkinggroup.eth",
                "blockchainpolicy.eth",
                "zksushi.eth",
                "starknetnode.eth",
                "starkwaredao.eth",
                "zksettlement.eth",
                "ethereumtv.eth",
                "desocmeetup.eth",
                "zkhash.eth",
                "zktutorial.eth",
                "zktime.eth",
                "zkcodecamp.eth",
                "rollupconnect.eth",
                "tokenregulation.eth",
                "zktalk.eth",
                "zkbridge.eth",
                "zkself.eth",
                "zkcall.eth",
                "zkpassport.eth",
                "zkaave.eth",
                "starknetlink.eth",
                "zkmedia.eth",
                "zkencryption.eth",
                "starknetverse.eth",
                "whitenft.eth",
                "zkgame.eth",
                "zkverse.eth",
                "blockchainpolitics.eth",
                "zkguild.eth",
                "web3tvdao.eth",
                "blackzk.eth",
                "zkwatch.eth",
                "zk1337.eth",
                "desocgames.eth",
                "zktax.eth",
                "zkpayments.eth",
                "landcadastre.eth",
                "zkaccount.eth",
                "zksignature.eth",
                "zkprofile.eth",
                "zkpersona.eth",
                "zkstaking.eth",
                "themetaid.eth",
                "zkcartel.eth",
                "zkcadaster.eth",
                "bcgov.eth",
                "zkpost.eth",
                "beaconbridge.eth",
                "daoreport.eth",
                "atomicbridge.eth",
                "zkcloud.eth",
                "zktoken.eth",
                "1person1vote.eth",
                "zkavatar.eth",
                "web3tv.eth",
                "starkmint.eth",
                "daovoting.eth",
                "gigazk.eth",
                "0xmeetup.eth",
                "ethereumdesoc.eth",
                "zkzone.eth",
                "zkfactory.eth",
                "starknetchain.eth",
                "pinknft.eth",
                "starksearch.eth",
                "zkprivacy.eth",
                "zkcompute.eth",
                "tokenpolitics.eth",
                "zkcrypto.eth",
                "meta1337.eth",
                "datasharding.eth",
                "zkstack.eth",
                "zkprograms.eth",
                "starkvm.eth",
                "starkhouse.eth",
                "securemultipartycomputation.eth",
                "starkweb.eth",
                "tokenpolicy.eth",
                "zkrouter.eth",
                "zkballot.eth",
                "0xlayer.eth",
                "bcgovernance.eth",
                "zkwire.eth",
                "web3key.eth",
                "zktwitter.eth",
                "zkdefi.eth",
                "zkmessage.eth",
                "zkstates.eth",
                "zkpoll.eth",
                "metaversemeetup.eth",
                "landcadaster.eth",
                "zkmooc.eth",
                "zkparty.eth",
                "thorzk.eth",
                "zkexchange.eth",
                "globaldesoc.eth",
                "metadesoc.eth",
                "desocnation.eth",
                "zksigning.eth",
                "zkearn.eth",
                "blockchainregulation.eth",
                "starkgames.eth",
                "snarkserver.eth",
                "zkrelayer.eth",
                "zkdemocracy.eth",
                "zkmixer.eth",
                "starkchain.eth",
                "nftworldnews.eth",
                "zkcash.eth",
                "zkstorage.eth",
                "thesisdao.eth",
                "metaversepolitics.eth",
                "desocverse.eth",
                "zksmart.eth",
                "zkcoding.eth",
                "rollupbridge.eth",
                "walletkey.eth",
                "starkbridge.eth",
                "blacknfts.eth",
                "starkmarket.eth",
                "metazk.eth",
                "starkdai.eth",
                "zktrading.eth",
                "daotv.eth",
                "metapolicy.eth",
                "zkportfolio.eth",
                "zksoul.eth",
                "zkinfo.eth",
                "zkberlin.eth",
                "1337zk.eth",
                "zkdevtools.eth",
                "proofnode.eth",
                "zksafety.eth",
                "zkplay.eth",
                "zkblitz.eth",
                "blacknft.eth",
                "starkbot.eth",
                "datalayer.eth",
                "zkmeme.eth",
                "zkident.eth",
                "zknetwork.eth",
                "zkland.eth",
                "zksdk.eth",
                "themetaverseid.eth",
                "thorbridge.eth",
                "c2h6o.eth",
                "zkcontract.eth",
                "zkidentity.eth",
                "starkkey.eth",
                "zkuniswap.eth",
                "zksale.eth",
                "zklibrary.eth",
                "0knowledge.eth",
                "zkchains.eth",
                "zklaw.eth",
                "zkdesign.eth",
                "zkstreet.eth",
                "starknetdao.eth",
                "starkgame.eth",
                "privacyisnormal.eth",
                "blockchainlink.eth",
                "zkaddress.eth",
                "zkvoip.eth",
                "consensusgovernance.eth",
                "zkhero.eth",
                "metaversedailynews.eth",
                "onepersononevote.eth",
                "zkinternet.eth",
                "zkpayment.eth",
                "decentralizedorganisation.eth",
                "zkconference.eth",
                "zkaudit.eth",
                "starkserver.eth",
                "zkradio.eth",
                "starknews.eth",
                "daometrics.eth",
                "zkthor.eth",
                "starknetnews.eth",
                "zkalpha.eth",
                "zkmeta.eth",
                "zkencrypt.eth",
                "zktimes.eth",
                "zkclub.eth",
                "zkbrowser.eth",
                "metaversepolicy.eth",
                "starkworld.eth",
                "zkproofs.eth",
                "metaversegovernance.eth",
                "zkcryptography.eth",
                "atomicledger.eth",
                "daoauthority.eth",
                "zkid.eth",
                "zk000.eth",
                "decomposable.eth",
                "zknames.eth",
                "tokenlaw.eth",
            ],
            "0xa7b7f3550f9b9611d12d6cf9e58fdbe63b7c4f86": ["guccimain.eth"],
            "0x1638e6e26f49c3b9ee48c03daf1097968c837851": ["vault.musa.eth"],
            "0xb428396d64b0a36c7765da55f64a6b2538d29589": ["knashi.eth"],
            "0xfdb7b75c8b21c03a3b8fabfabd0f6b9ba055cfab": ["0xobat.eth", "obatolo.eth"],
            "0x4e3c585aa99818552d23dced9e02876dbc74ef3b": [
                "nonut.eth",
                "millenialmoney.sismo.eth",
                "millenialmoney.eth",
            ],
        }
        results = get_names_for_wallets(set(expected_ens_records.keys()))
        for wallet, names in expected_ens_records.items():
            self.assertEqual(results[wallet], names, f"failed for wallet {wallet}")


if __name__ == "__main__":
    unittest.main()
